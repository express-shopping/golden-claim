<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Golden Claim | Global Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #f3ba2f; --bg: #000000; --card: #1c1f24; --text-gray: #848e9c; }
        
        body { 
            margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; 
            user-select: none; -webkit-tap-highlight-color: transparent; overflow: hidden;
        }

        .app-container { height: 100vh; display: flex; flex-direction: column; }

        /* Header like Hamster */
        .top-nav { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: #000; }
        .user-pill { background: #1c1f24; padding: 5px 12px; border-radius: 20px; border: 1px solid #333; font-size: 13px; font-weight: bold; color: var(--gold); }

        /* Balance Display */
        .balance-card { text-align: center; padding: 25px 0; background: radial-gradient(circle at top, #1c1f24 0%, #000 100%); }
        .coin-icon { width: 45px; vertical-align: middle; margin-right: 8px; }
        .total-bal { font-size: 45px; font-weight: 900; color: #fff; vertical-align: middle; }

        /* Main Game Area */
        .game-area { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .circle-outer { 
            width: 280px; height: 280px; border-radius: 50%; background: #1c1f24; 
            display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 0 50px rgba(243,186,47,0.1); border: 5px solid #282c34;
        }
        .main-character { 
            width: 240px; height: 240px; border-radius: 50%; 
            background: url('https://cdn-icons-png.flaticon.com/512/6585/6585012.png') no-repeat center;
            background-size: 85%; cursor: pointer; transition: transform 0.1s;
        }
        .main-character:active { transform: scale(0.94); }

        /* Tabs System */
        .content-page { display: none; padding: 15px; height: 100%; overflow-y: auto; padding-bottom: 100px; }
        .content-page.active { display: block; }

        /* Hamster Style Cards */
        .upgrade-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .u-card { 
            background: var(--card); border-radius: 16px; padding: 12px; 
            border: 1px solid #2d333b; position: relative;
        }
        .u-card img { width: 50px; height: 50px; border-radius: 10px; margin-bottom: 10px; }
        .u-title { font-size: 13px; font-weight: bold; color: #fff; display: block; }
        .u-profit { font-size: 11px; color: var(--text-gray); margin-top: 4px; }
        .u-price { font-size: 14px; font-weight: 900; color: var(--gold); margin-top: 10px; display: block; }
        .lvl-badge { position: absolute; top: 10px; left: 10px; background: #2d333b; font-size: 10px; padding: 2px 6px; border-radius: 5px; }

        /* Bottom Menu */
        .footer-nav { 
            position: fixed; bottom: 0; width: 100%; background: #1c1f24; 
            display: flex; justify-content: space-around; padding: 10px 0;
            border-top: 1px solid #333;
        }
        .nav-tab { text-align: center; color: var(--text-gray); font-size: 11px; text-decoration: none; flex: 1; }
        .nav-tab.active { color: var(--gold); }
        .nav-tab i { font-size: 20px; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="top-nav">
        <div id="ton-connect"></div>
        <div class="user-pill" id="user-display">Loading...</div>
    </div>

    <div id="page-mine" class="content-page active">
        <div class="balance-card">
            <img src="https://cdn-icons-png.flaticon.com/512/6585/6585012.png" class="coin-icon">
            <span class="total-bal" id="balance">0.0000</span>
        </div>
        <div class="game-area">
            <div class="circle-outer">
                <div class="main-character" onclick="doMine()"></div>
            </div>
            <div id="timer" style="margin-top: 25px; color: var(--gold); font-weight: 900; font-size: 18px;">READY TO CLAIM! âš¡</div>
        </div>
    </div>

    <div id="page-cards" class="content-page">
        <h3 style="margin-bottom: 20px;">ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª ğŸš€</h3>
        <div class="upgrade-grid">
            <div class="u-card">
                <span class="lvl-badge">Lvl 1</span>
                <img src="https://cdn-icons-png.flaticon.com/512/743/743007.png">
                <span class="u-title">Ø³ÙŠØ§Ø±Ø© Ø±ÙŠØ§Ø¶ÙŠØ©</span>
                <span class="u-profit">Profit +0.05</span>
                <span class="u-price">50.00 ğŸ’°</span>
            </div>
            <div class="u-card">
                <span class="lvl-badge">Lvl 1</span>
                <img src="https://cdn-icons-png.flaticon.com/512/609/609803.png">
                <span class="u-title">ÙÙŠÙ„Ø§ Ø®Ø§ØµØ©</span>
                <span class="u-profit">Profit +0.15</span>
                <span class="u-price">150.00 ğŸ’°</span>
            </div>
            <div class="u-card">
                <span class="lvl-badge">Lvl 1</span>
                <img src="https://cdn-icons-png.flaticon.com/512/2645/2645167.png">
                <span class="u-title">Ù…Ø­Ø·Ø© ÙØ¶Ø§Ø¡</span>
                <span class="u-profit">Profit +1.50</span>
                <span class="u-price">2500.00 ğŸ’°</span>
            </div>
            <div class="u-card">
                <span class="lvl-badge">Lvl 1</span>
                <img src="https://cdn-icons-png.flaticon.com/512/9446/9446547.png">
                <span class="u-title">Ø¬Ø²ÙŠØ±Ø© Ø°Ù‡Ø¨ÙŠØ©</span>
                <span class="u-profit">Profit +5.00</span>
                <span class="u-price">10000 ğŸ’°</span>
            </div>
        </div>
    </div>

    <div class="footer-nav">
        <div class="nav-tab active" onclick="switchTab('page-mine', this)">â›ï¸<br>Ø§Ù„ØªØ¹Ø¯ÙŠÙ†</div>
        <div class="nav-link nav-tab" onclick="switchTab('page-cards', this)">ğŸš€<br>Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
        <div class="nav-tab">ğŸ‘¥<br>Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</div>
        <div class="nav-tab">ğŸ<br>Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</div>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyBzNnLCKo1Zn5XH602UGN8jPDX5kp9jsjA",
        authDomain: "goldenclaim-6863a.firebaseapp.com",
        databaseURL: "https://goldenclaim-6863a-default-rtdb.firebaseio.com",
        projectId: "goldenclaim-6863a",
        storageBucket: "goldenclaim-6863a.firebasestorage.app",
        messagingSenderId: "817930053370",
        appId: "1:817930053370:web:2e0a807e47c4a7ad868b43"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const uid = tg.initDataUnsafe.user?.id || "test_user";

    // TON Connect
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
        manifestUrl: 'https://express-shopping.github.io/golden-claim/tonconnect-manifest.json',
        buttonRootId: 'ton-connect'
    });

    let userData = {};

    function syncData() {
        db.ref('users/' + uid).on('value', s => {
            if(s.exists()){
                userData = s.val();
                document.getElementById('balance').innerText = userData.balance.toFixed(4);
                updateTimer();
            }
            document.getElementById('user-display').innerText = tg.initDataUnsafe.user?.first_name || "Mugahed";
        });
    }

    function doMine() {
        const cooldown = 300000; // 5 min
        const now = Date.now();
        if (now - (userData.last || 0) >= cooldown) {
            db.ref('users/' + uid).update({
                balance: (userData.balance || 0) + (userData.power || 0.0001),
                last: now
            });
            tg.HapticFeedback.impactOccurred('heavy');
        } else {
            tg.HapticFeedback.notificationOccurred('warning');
        }
    }

    function updateTimer() {
        const rem = 300000 - (Date.now() - (userData.last || 0));
        if (rem > 0) {
            const m = Math.floor(rem / 60000);
            const s = Math.floor((rem % 60000) / 1000);
            document.getElementById('timer').innerText = `NEXT CLAIM: ${m}:${s < 10 ? '0'+s : s}`;
            setTimeout(updateTimer, 1000);
        } else {
            document.getElementById('timer').innerText = "READY TO CLAIM! âš¡";
        }
    }

    function switchTab(id, el) {
        document.querySelectorAll('.content-page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-tab').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    syncData();
</script>
</body>
</html>

